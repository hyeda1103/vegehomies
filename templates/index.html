<!DOCTYPE html>
<html>

<head>
    <!-- WebPage Title -->
    <title>ìˆ ê³ ë˜ëŠ” ì±„ì‹ì£¼ì˜ì</title>
    <link href="static/stylesheet.css" rel="stylesheet" type="text/css">

    <!-- Required Meta Tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js'></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&display=swap" rel="stylesheet">

    <!-- favicon -->
    <link href="static/yeolsi.jpg" rel="shortcut icon">


</head>


<body>
    <div class="map_wrap" id="grad1" style="height: 100vh; padding: 10px;">

        <div id="map" style="width: 54.5%; height:100%; position:relative;
        overflow:hidden; margin-left: 45.45%; border-radius: 10px;"></div>

        <!-- ì¥ì†Œì™€ ìš”ì¼ ê¸°ë°˜ ê²€ìƒ‰ -->
        <div id="menu_wrap" class="bg_white">

            <div class="searchContainer">
                <form onsubmit="searchPlaces(); return false;">
                    <div>
                        <input type="text" class="searchBox" placeholder=" " id="search">
                        <button id="searchBtn" class="searchButton" type="submit">ê²€ìƒ‰</button>
                    </div>
                </form>

            </div>


            <button id="searchBtn" class="filterBtn" type="submit" onclick="filter()"
                style="margin-bottom: 1em;">í•„í„°ì¶”ê°€</button>
            <div id=filterDiv>
                <div id="filterDiv1" class="dayFilter" style="font-size: 14px; margin: 0.5em;">
                    <input id="searchBtn" class="filterChk" type="checkbox" value="ì¼" onclick="filterSelection()">
                    ì¼ìš”ì¼</input> &nbsp;
                    <input id="searchBtn" class="filterChk" type="checkbox" value="ì›”" onclick="filterSelection()">
                    ì›”ìš”ì¼</input> &nbsp;
                    <input id="searchBtn" class="filterChk" type="checkbox" value="í™”" onclick="filterSelection()">
                    í™”ìš”ì¼</input> &nbsp;
                    <input id="searchBtn" class="filterChk" type="checkbox" value="ìˆ˜" onclick="filterSelection()">
                    ìˆ˜ìš”ì¼</input> <br>
                    <input id="searchBtn" class="filterChk" type="checkbox" value="ëª©" onclick="filterSelection()">
                    ëª©ìš”ì¼</input> &nbsp;
                    <input id="searchBtn" class="filterChk" type="checkbox" value="ê¸ˆ" onclick="filterSelection()">
                    ê¸ˆìš”ì¼</input> &nbsp;
                    <input id="searchBtn" class="filterChk" type="checkbox" value="í† " onclick="filterSelection()">
                    í† ìš”ì¼</input>
                </div>

                <div id="filterDiv2" class="menuFilter" style="font-size: 14px; margin: 0.5em;">
                    <input id="searchBtn" class="filterChk2" type="checkbox" value="15" onclick="filterSelection()">
                    ë‚®(ì˜¤í›„ 2ì‹œ ì „ì— ì—´ì–´ìš”)</input> <br>
                    <input id="searchBtn" class="filterChk2" type="checkbox" value="22" onclick="filterSelection()">
                    ì‹¬ì•¼(ìƒˆë²½ì— ë¬¸ì„ ë‹«ì•„ìš”)</input>
                </div>
            </div>


            <p id="numofResults" class="informResults"></p>

            <hr>

            <ul id="placesList"></ul>

        </div>

        <!-- ì•ˆì£¼ì™€ ìˆ  ê¸°ë°˜ ê²€ìƒ‰ -->
        <div id="menu_wrap2" class="bg_white2">

            <div>
                <button id="searchBtn" class="toggleButton" type="submit" onclick="showMenu();"> ì˜ì°¨ì˜ì°¨ğŸ¢</button>
            </div>

            <br>
            <button id="searchBtn" class="filterBtn" type="submit" onclick="filter2();"
                style="margin-bottom: 1em;">í•„í„°ì¶”ê°€</button>

            <div id="filter2Div" style="margin-bottom: 0.5em;">

                <div id="filterDiv3" class="menuFilter" style="font-size: 14px; margin: 0.5em;">
                    <input id="searchBtn" class="filterChk3" type="checkbox" value="ë§ˆë¥¸ì•ˆì£¼" onclick="filterSelection2()">
                    ë§ˆë¥¸ì•ˆì£¼</input> &nbsp;
                    <input id="searchBtn" class="filterChk3" type="checkbox" value="íƒ•" onclick="filterSelection2()">
                    íƒ•</input> &nbsp;
                    <input id="searchBtn" class="filterChk3" type="checkbox" value="ë³¶ìŒ" onclick="filterSelection2()">
                    ë³¶ìŒ</input> &nbsp;
                    <input id="searchBtn" class="filterChk3" type="checkbox" value="êµ¬ì´" onclick="filterSelection2()">
                    êµ¬ì´</input> <br>
                    <input id="searchBtn" class="filterChk3" type="checkbox" value="ë©´" onclick="filterSelection2()">
                    ë©´</input> &nbsp;   
                    <input id="searchBtn" class="filterChk3" type="checkbox" value="ì „" onclick="filterSelection2()">
                    ì „</input> &nbsp;
                    <input id="searchBtn" class="filterChk3" type="checkbox" value="íŠ€ê¹€" onclick="filterSelection2()">
                    íŠ€ê¹€</input> &nbsp;
                    <input id="searchBtn" class="filterChk3" type="checkbox" value="ìƒëŸ¬ë“œ" onclick="filterSelection2()">
                    ìƒëŸ¬ë“œ</input> &nbsp;
                </div>

                <div id="filterDiv4" class="priceFilter" style="font-size: 14px; margin: 0.5em; margin-bottom: 1em;">
                    <input id="searchBtn" class="filterChk4" type="checkbox" value="10000" onclick="filterSelection2()">
                    ~ 10,000ì›</input> &nbsp;
                    <input id="searchBtn" class="filterChk4" type="checkbox" value="15000" onclick="filterSelection2()">
                    ~ 15,000ì›</input> &nbsp;
                    <input id="searchBtn" class="filterChk4" type="checkbox" value="20000" onclick="filterSelection2()">
                    ~ 20,000ì›</input>
                </div>

            </div>

            <hr>

            <br>

            <ul id="menuList" style="font-size: 14px;"></ul>

        </div>

    </div>



    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1a3b30143ac575087758f5d636d25c4c&libraries=services"></script>


    <script>
        var mapContainer = document.getElementById('map'), // ì§€ë„ë¥¼ í‘œì‹œí•  div  
            mapOption = {
                center: new kakao.maps.LatLng(37.5638, 126.9084), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
                level: 6 // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
            };

        var map = new kakao.maps.Map(mapContainer, mapOption); // ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤

        // ì§€ë„ í™•ëŒ€ ì¶•ì†Œë¥¼ ì œì–´í•  ìˆ˜ ìˆëŠ”  ì¤Œ ì»¨íŠ¸ë¡¤ì„ ìƒì„±í•©ë‹ˆë‹¤
        var zoomControl = new kakao.maps.ZoomControl();
        map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);

        // ë§ˆì»¤ë¥¼ ë‹´ì„ ë°°ì—´ì…ë‹ˆë‹¤
        var markers = [];


        // í‚¤ì›Œë“œë¡œ ì¥ì†Œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
        $(document).ready(function () {
            searchPlaces();
            showMenu();
        });



        // í‚¤ì›Œë“œ ê²€ìƒ‰ì„ ìš”ì²­í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
        function searchPlaces() {
            $.ajax({
                type: 'GET',
                url: '/vegeInfo',
                data: {},
                success: function (response) {

                    if (response['result'] == 'success') {
                        let drunkenVege = response['drunkenVege']

                        // DBì— ìˆëŠ” ë¹„ê±´ìˆ ì§‘ ì´ë¦„ì„ ëœë¤ìœ¼ë¡œ ê³¨ë¼ì„œ placeholderê°’ìœ¼ë¡œ ë„£ìŠµë‹ˆë‹¤. 
                        var list = [];

                        for (let i = 0; i < drunkenVege.length; i++) {
                            var name = drunkenVege[i]['name'];
                            list.push(name);
                            
                        }

                        var list, r = Math.floor(Math.random() * list.length);
                    

                        document.getElementById('search').placeholder = list[r];

                        // ê²€ìƒ‰ì°½ì— í‚¤ì›Œë“œê°€ ì…ë ¥í•˜ê¸°ë¥¼ ìš”ì²­í•©ë‹ˆë‹¤.
                        var keyword = document.getElementById('search').value;

                        displayPlaces(drunkenVege, keyword);

                    }
                }
            })
        }



        // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ê³¼ ë§ˆì»¤ë¥¼ í‘œì¶œí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
        function displayPlaces(drunkenVege, keyword) {

            // ê²€ìƒ‰ì–´ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ëŠ” ê²½ìš° ê¸°ì¡´ì— ì²´í¬ëœ í•„í„°ì¡°ê±´ì€ ë¦¬ì…‹í•©ë‹ˆë‹¤
            $('input:checkbox').removeAttr('checked');


            if (!keyword.replace(/^\s+|\s+$/g, '')) {
                // alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                displayMarkers(drunkenVege);


            } else {

                // ê²€ìƒ‰ì¡°ê±´ì— ì•Œë§ì€ ë¹„ê±´ìˆ ì§‘ì •ë³´ë¥¼ ë‹´ì„ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                var places = [];

                for (let i = 0; i < drunkenVege.length; i++) {

                    // íŠ¹ìˆ˜ë¬¸ì í¬í•¨ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•œ ì •ê·œí‘œí˜„ì‹ 
                    var regExp = /[ \{\}\[\]\/?.,;:|\)*~`!^\-_+â”¼<>@\#$%&\ '\"\\(\=]/gi;


                    // DB ì§€ì—­êµ¬
                    var district = drunkenVege[i]['district'];
                    var cityOnly = district.split(' ')[0];
                    var citynameOnly = cityOnly.slice(0, -1);
                    var districtOnly = district.split(' ')[1];
                    var districtRe = district.replace(/(\s*)/g, ""); // ì§€ì—­êµ¬ì˜ ëª¨ë“  ê³µë°±ì„ ì œê±°
                    var newDistrict = districtRe.replace(regExp, ""); // ëª¨ë“  íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œê±°


                    // DB ì‹ë‹¹ì´ë¦„
                    var name = drunkenVege[i]['name'];
                    var nameRe = name.replace(/(\s*)/g, ""); // ì´ë¦„ì˜ ëª¨ë“  ê³µë°±ì„ ì œê±°
                    var newName = nameRe.replace(regExp, ""); // ëª¨ë“  íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œê±°


                    // ì…ë ¥ëœ í‚¤ì›Œë“œ
                    var keyword = document.getElementById('search').value;
                    var keywordRe = keyword.replace(/(\s*)/g, ""); // í‚¤ì›Œë“œì˜ ëª¨ë“  ê³µë°±ì„ ì œê±°
                    var newKeyword = keywordRe.replace(regExp, ""); // ëª¨ë“  íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œê±°


                    if (newKeyword == newDistrict || newKeyword == newName || newKeyword == cityOnly || newKeyword == citynameOnly || newKeyword == districtOnly) {
                        places.push(drunkenVege[i]);
                    }
                }

                

                if (places.length != 0) {

                    displayMarkers(places);

                } else {

                    // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ì— ì¶”ê°€ëœ í•­ëª©ë“¤ì„ ì œê±°í•©ë‹ˆë‹¤
                    var listEl = document.getElementById('placesList');
                    removeAllChildNods(listEl);

                    // ì§€ë„ë¥¼ ì¬ì„¤ì •í•  ë²”ìœ„ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì„ LatLngBounds ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                    var bounds = new kakao.maps.LatLngBounds();

                    // ì§€ë„ì— í‘œì‹œë˜ê³  ìˆëŠ” ë§ˆì»¤ë¥¼ ì œê±°í•©ë‹ˆë‹¤
                    removeMarker();

                    // ê²€ìƒ‰ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒì„ í‘œê¸°í•©ë‹ˆë‹¤
                    document.getElementById("numofResults").innerHTML = '<p>' + 'ê²€ìƒ‰ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' + '</p>';

                    // 2ì´ˆ ë’¤ì— í‘œê¸°í•œ ë©”ì‹œì§€ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤
                    $('#numofResults').fadeIn('slow', function () {
                        $('#numofResults').delay(2000)

                    });

                    // ê²€ìƒ‰ì–´ë¥¼ ë¦¬ì…‹í•©ë‹ˆë‹¤
                    var keyword = '';

                    // 3ì´ˆ ë’¤ì— ê²€ìƒ‰ ì²« í™”ë©´ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤
                    setTimeout(() => {
                        displayPlaces(drunkenVege, keyword);
                    }, 2000);
                }
            }

        }



        // ê²€ìƒ‰ê²°ê³¼ í•­ëª©ì„ Elementë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function getListItem(index, places) {

            var instaUrl = "http://www.instagram.com/" + places.instaID + "/?hl=ko";

            var el = document.createElement('li'),
                itemStr = '<div id = "vegeRestaurant" onclick="reboundMap(\'' + places.instaID + '\')">' + '<span class="markerbg marker_' + (index + 1) + '"></span>' +
                    '<div class="info">' +
                    '   <h5>' + places.name + '</h5>';

            itemStr += '    <span>' + places.address + '</span>';

            itemStr += '    <span>' + places.runningtime + '</span>';

            itemStr += '<a href="' + instaUrl + '" target="_blank">' + '<span class="tel">' + '@' + places.instaID + '</span>' + '</a>';

            itemStr += '<button id="searchBtn" onclick="searchMenu(\'' + places.instaID + '\');" class="toggleButton" type="submit">' + 'ì•ˆì£¼êµ¬ê²½ğŸ‘€' + '</button>';

            itemStr += '<br>' + '<div id="menuBox">' + '</div>' + '</div>';


            el.innerHTML = itemStr;
            el.className = 'item';

            return el;


        }


        function showMenu() {
            $.ajax({
                type: 'GET',
                url: '/vegeInfo',
                data: {},
                success: function (response) {

                    space = [];

                    if (response['result'] == 'success') {
                        let drunkenVege = response['drunkenVege']

                        for (i = 0; i < drunkenVege.length; i++) {
                            let instaID = drunkenVege[i]['instaID']
                            
                            space.push(drunkenVege[i]);

                        }

                        menuList = [];

                        for (j = 0; j < space.length; j++) {
                            menuList.push(space[j]['menu'].split('/'));
                        }

                        let menuListEl = document.getElementById('menuList');

                        removeAllChildNods(menuListEl);

                        for (i = 0; i < menuList.length; i++) {

                            for (j = 0; j < menuList[i].length; j++) {

                                var x = document.createElement("li");

                                var menuName = 'ğŸ‘½' + menuList[i][j].split('+')[0];

                                var menuPrice = 'âš¡' + menuList[i][j].split('+')[1] + 'ì›';

                                var menuNamePrice = menuName + '   ' + menuPrice;


                                var t = document.createTextNode(menuNamePrice);

                                x.appendChild(t);

                                document.getElementById("menuList").appendChild(x);

                            }


                        }

                    }
                }
            })
        }



        function searchMenu(bar) {

            $.ajax({
                type: 'GET',
                url: '/vegeInfo',
                data: {},
                success: function (response) {

                    space = [];

                    if (response['result'] == 'success') {
                        let drunkenVege = response['drunkenVege']

                        for (i = 0; i < drunkenVege.length; i++) {
                            let instaID = drunkenVege[i]['instaID']
                            
                            if (bar == instaID) {
                                space.push(drunkenVege[i]);
                            }

                        }

                        let menuList = space[0]['menu'].split('/');

                        let menuListEl = document.getElementById('menuList');
                        removeAllChildNods(menuListEl);

                        for (i = 0; i < menuList.length; i++) {

                            var x = document.createElement("li");

                            var menuName = 'ğŸ‘½' + menuList[i].split('+')[0];

                            var menuPrice = 'âš¡' + menuList[i].split('+')[1] + 'ì›';

                            var menuNamePrice = menuName + '   ' + menuPrice;


                            var t = document.createTextNode(menuNamePrice);

                            x.appendChild(t);

                            document.getElementById("menuList").appendChild(x);


                        }

                    }
                }
            })
        }


        // ëª©ë¡ì°½ì˜ íŠ¹ì • item divë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹í•˜ëŠ” ë¹„ê±´ìˆ ì§‘ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì§€ë„ ë²”ìœ„ë¥¼ ì¬ì„¤ì •í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        // ex) í¬ì¸íŠ¸í”„ë ˆë“œë¦­ div í´ë¦­í•˜ë©´ í¬ì¸íŠ¸í”„ë ˆë“œë¦­ ë§ˆì»¤ê°€ ì§€ë„ ì¤‘ì‹¬ìœ¼ë¡œ ëœ¬ë‹¤. 
        function reboundMap(bar) {
            $.ajax({
                type: 'GET',
                url: '/vegeInfo',
                data: {},
                success: function (response) {

                    space = [];

                    if (response['result'] == 'success') {
                        let drunkenVege = response['drunkenVege']

                        for (i = 0; i < drunkenVege.length; i++) {
                            let instaID = drunkenVege[i]['instaID']
                            

                            if (bar == instaID) {
                                space.push(drunkenVege[i]);

                                var point = new kakao.maps.LatLng(space[0]['latitude'], space[0]['longitude']);

                                var bounds = new kakao.maps.LatLngBounds();

                                bounds.extend(point);

                                map.setBounds(bounds);

                            }
                        }
                    }
                }
            })
        }



        // ë§ˆì»¤ë¥¼ ìƒì„±í•˜ê³  ì§€ë„ ìœ„ì— ë§ˆì»¤ë¥¼ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function addMarker(placePosition, i, title) {
            var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png', // ë§ˆì»¤ ì´ë¯¸ì§€ url, ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ë¥¼ ì”ë‹ˆë‹¤
                imageSize = new kakao.maps.Size(36, 37), // ë§ˆì»¤ ì´ë¯¸ì§€ì˜ í¬ê¸°
                imgOptions = {
                    spriteSize: new kakao.maps.Size(36, 691), // ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ì˜ í¬ê¸°
                    spriteOrigin: new kakao.maps.Point(0, (i * 46) + 10), // ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ì¤‘ ì‚¬ìš©í•  ì˜ì—­ì˜ ì¢Œìƒë‹¨ ì¢Œí‘œ
                    offset: new kakao.maps.Point(13, 37) // ë§ˆì»¤ ì¢Œí‘œì— ì¼ì¹˜ì‹œí‚¬ ì´ë¯¸ì§€ ë‚´ì—ì„œì˜ ì¢Œí‘œ
                },
                markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imgOptions),
                marker = new kakao.maps.Marker({
                    map: map, // ë§ˆì»¤ë¥¼ í‘œì‹œí•  ì§€ë„
                    position: placePosition, // ë§ˆì»¤ë¥¼ í‘œì‹œí•  ìœ„ì¹˜
                    title: title, // ë§ˆì»¤ì˜ íƒ€ì´í‹€, ë§ˆì»¤ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ íƒ€ì´í‹€ì´ í‘œì‹œë©ë‹ˆë‹¤
                    image: markerImage // ë§ˆì»¤ ì´ë¯¸ì§€
                });

            marker.setMap(map); // ì§€ë„ ìœ„ì— ë§ˆì»¤ë¥¼ í‘œì¶œí•©ë‹ˆë‹¤
            markers.push(marker); // ë°°ì—´ì— ìƒì„±ëœ ë§ˆì»¤ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤

            return marker;
        }



        // ì§€ë„ ìœ„ì— í‘œì‹œë˜ê³  ìˆëŠ” ë§ˆì»¤ë¥¼ ëª¨ë‘ ì œê±°í•©ë‹ˆë‹¤
        function removeMarker() {
            for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(null);
            }
            markers = [];
        }



        // ê²€ìƒ‰ê²°ê³¼ ëª©ë¡ì˜ ìì‹ Elementë¥¼ ì œê±°í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function removeAllChildNods(el) {
            while (el.hasChildNodes()) {
                el.removeChild(el.lastChild);
            }
        }

        // ì¥ì†Œì™€ ìš”ì¼, ì‹œê°„ ê¸°ë°˜ ê²€ìƒ‰ì°½ì˜ í•„í„°ë¥¼ ì—´ê³  ë‹«ìŠµë‹ˆë‹¤
        function filter() {
            $('#filterDiv').slideToggle();

        }

        // ì•ˆì£¼ ê¸°ë°˜ ê²€ìƒ‰ì°½ì˜ í•„í„°ë¥¼ ì—´ê³  ë‹«ìŠµë‹ˆë‹¤
        function filter2() {
            $('#filter2Div').slideToggle();

        }

        // ì¥ì†Œì™€ ìš”ì¼, ì‹œê°„ ê¸°ë°˜ ê²€ìƒ‰ì°½ì˜ í•„í„°ë§ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function filterSelection() {
            $.ajax({
                type: 'GET',
                url: '/vegeInfo',
                data: {},
                success: function (response) {
                    let drunkenVege = response['drunkenVege'];
                    let resArr = drunkenVege;

                    var keyword = document.getElementById('search').value;

                    // ê²€ìƒ‰ì°½ì˜ keywordì™€ ì¼ì¹˜í•˜ëŠ” ìˆ ì§‘ ë°ì´í„°ë¥¼ ë‹´ìŠµë‹ˆë‹¤
                    var places = [];

                    // ìƒˆë²½ê¹Œì§€ ìš´ì˜í•˜ëŠ” ìˆ ì§‘ ë°ì´í„°ë¥¼ ë‹´ìŠµë‹ˆë‹¤
                    var placesForMidnight = [];

                    // ì˜¤í›„ 2ì‹œ ì´ì „ë¶€í„° ìš´ì˜í•˜ëŠ” ìˆ ì§‘ ë°ì´í„°ë¥¼ ë‹´ìŠµë‹ˆë‹¤
                    var placesForDaytime = [];

                    // ìš”ì¼ì„ ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë§í•œ ìˆ ì§‘ ë°ì´í„°ë¥¼ ë‹´ìŠµë‹ˆë‹¤

                    let sun = [];
                    let mon = [];
                    let tue = [];
                    let wed = [];
                    let thr = [];
                    let fri = [];
                    let sat = [];

                    let day = [sun, mon, tue, wed, thr, fri, sat];


                    for (let i = 0; i < drunkenVege.length; i++) {

                        // íŠ¹ìˆ˜ë¬¸ì í¬í•¨ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•œ ì •ê·œí‘œí˜„ì‹ 
                        var regExp = /[ \{\}\[\]\/?.,;:|\)*~`!^\-_+â”¼<>@\#$%&\ '\"\\(\=]/gi;


                        // DB ì§€ì—­êµ¬
                        var district = drunkenVege[i]['district'];
                        var cityOnly = district.split(' ')[0];
                        var citynameOnly = cityOnly.slice(0, -1);
                        var districtOnly = district.split(' ')[1];
                        var districtRe = district.replace(/(\s*)/g, ""); // ì§€ì—­êµ¬ì˜ ëª¨ë“  ê³µë°±ì„ ì œê±°
                        var newDistrict = districtRe.replace(regExp, ""); // ëª¨ë“  íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œê±°


                        // DB ì‹ë‹¹ì´ë¦„
                        var name = drunkenVege[i]['name'];
                        var nameRe = name.replace(/(\s*)/g, ""); // ì´ë¦„ì˜ ëª¨ë“  ê³µë°±ì„ ì œê±°
                        var newName = nameRe.replace(regExp, ""); // ëª¨ë“  íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œê±°


                        // ì…ë ¥ëœ í‚¤ì›Œë“œ
                        var keyword = document.getElementById('search').value;
                        var keywordRe = keyword.replace(/(\s*)/g, ""); // í‚¤ì›Œë“œì˜ ëª¨ë“  ê³µë°±ì„ ì œê±°
                        var newKeyword = keywordRe.replace(regExp, ""); // ëª¨ë“  íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œê±°


                        if (newKeyword == newDistrict || newKeyword == newName || newKeyword == cityOnly || newKeyword == citynameOnly || newKeyword == districtOnly) {
                            places.push(drunkenVege[i]);
                        }

                        // ë¹„ê±´ìˆ ì§‘ ìš”ì¼ë³„ ìš´ì˜ì‹œê°„ì„ ì •ë¦¬í•´ë†“ì€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤
                        let runningTimeDay = drunkenVege[i]['runningtime'];

                        // ìš”ì¼ë³„ ìš´ì˜ì‹œê°„ì´ ë‹¤ë¥¸ ê²½ìš°, ìˆ ì§‘ ë¬¸ì„ ì—¬ëŠ” ì‹œê°„ê³¼ ë‹«ëŠ” ì‹œê°„ì„ êµ¬í•©ë‹ˆë‹¤
                        if (runningTimeDay.includes('/')) {

                            runningTimeDay = runningTimeDay.split('/');
                            
                            for (j = 0; j < runningTimeDay.length; j++) {

                                let runningTime = runningTimeDay[j].split('(')[0];
                                let runningDay = runningTimeDay[j].split('(')[1].split(')')[0];

                                let openingTime = runningTime.split('-')[0];
                                let closingTime = runningTime.split('-')[1];

                                if (openingTime.includes(':')) {

                                    openingTime = Number(openingTime.split(':')[0]) + 1;

                                }

                                if (closingTime.includes(':')) {

                                    closingTime = Number(openingTime.split(':')[0]) + 1;

                                }

                                
                                // ì—¬ëŠ” ì‹œê°„ì´ ì˜¤í›„ 2ì‹œ ì´ì „ì¸ ìˆ ì§‘ì˜ ì •ë³´ë¥¼ placesForDaytimeì— ë‹´ìŠµë‹ˆë‹¤
                                if (openingTime < 14) {

                                    placesForDaytime.push(drunkenVege[i]);

                                }
                                // ë‹«ëŠ” ì‹œê°„ì´ ìƒˆë²½ì‹œê°„ëŒ€ì¸ ìˆ ì§‘ì˜ ì •ë³´ë¥¼ placesForMidnightì— ë‹´ìŠµë‹ˆë‹¤
                                if (closingTime < 6 || closingTime == '*') {

                                    placesForMidnight.push(drunkenVege[i]);

                                }

                            }
                        }
                        // ìš”ì¼ê³¼ ìƒê´€ì—†ì´ ìš´ì˜ì‹œê°„ì´ ë™ì¼í•œ ê²½ìš°, ìˆ ì§‘ ë¬¸ì„ ì—¬ëŠ” ì‹œê°„ê³¼ ë‹«ëŠ” ì‹œê°„ì„ êµ¬í•©ë‹ˆë‹¤
                        else {
                            let runningTime = runningTimeDay.split('(')[0];
                            let runningDay = runningTimeDay.split('(')[1].split(')')[0];
                            let openingTime = runningTime.split('-')[0];
                            let closingTime = runningTime.split('-')[1];

                            if (openingTime.includes(':')) {

                                openingTime = Number(openingTime.split(':')[0]) + 1;

                            }

                            if (closingTime.includes(':')) {

                                closingTime = Number(closingTime.split(':')[0]) + 1;

                            }

                            // ì—¬ëŠ” ì‹œê°„ì´ ì˜¤í›„ 2ì‹œ ì´ì „ì¸ ìˆ ì§‘ì˜ ì •ë³´ë¥¼ placesForDaytimeì— ë‹´ìŠµë‹ˆë‹¤
                            if (openingTime < 14) {

                                placesForDaytime.push(drunkenVege[i]);

                            }
                            // ë‹«ëŠ” ì‹œê°„ì´ ìƒˆë²½ì‹œê°„ëŒ€ì¸ ìˆ ì§‘ì˜ ì •ë³´ë¥¼ placesForMidnightì— ë‹´ìŠµë‹ˆë‹¤
                            if (closingTime < 6 || closingTime == '*') {

                                placesForMidnight.push(drunkenVege[i]);

                            }


                        }
                    }

                    // ì¤‘ë³µë˜ëŠ” ì •ë³´ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤
                    placesForDaytime = [...new Set(placesForDaytime)];
                    placesForMidnight = [...new Set(placesForMidnight)];

                    // í‚¤ì›Œë“œì™€ ì¼ì¹˜í•˜ëŠ” ìˆ ì§‘ ì •ë³´ë¥¼ keywordResArrì— ë‹´ìŠµë‹ˆë‹¤ 
                    let keywordResArr = places;

                    // í•„í„°ë§ ê¸°ì¤€ì´ ìš”ì¼ì¸ ì²´í¬ë°•ìŠ¤ë“¤ì„ filterChkë¡œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤
                    let filtChk = document.querySelectorAll(".filterChk");

                    // filterChkì˜ ìš”ì¼ valueë¥¼ filterElì— ë‹´ìŠµë‹ˆë‹¤
                    let filterEl = [];

                    for (i = 0; i < filtChk.length; i++) {
                        filterEl.push(filtChk[i]['value']);
                    }

                    // í•„í„°ë§ ê¸°ì¤€ì´ ì‹œê°„ì¸ ì²´í¬ë°•ìŠ¤ë“¤ì„ filterChk2ë¡œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤
                    let filtChk2 = document.querySelectorAll(".filterChk2");


                    // ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ í•„í„°ë§í•˜ëŠ” ê²½ìš°
                    if (keyword == '') {

                        for (i = 0; i < filtChk.length; i++) {
                            for (j = 0; j < filtChk2.length; j++) {

                                // ìš”ì¼ + ë‚®ìˆ 
                                if (filtChk[i].checked == true && filtChk2[0].checked == true && filtChk2[1].checked == false) {


                                    day[i] = resArr.filter(function (resArr) {
                                        return resArr['runningtime'].includes(filterEl[i]);
                                    })

                                    let union = [...new Set([...day[0], ...day[1], ...day[2], ...day[3], ...day[4], ...day[5], ...day[6]])];


                                    // ìš”ì¼ì„ ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë§í•œ ìˆ ì§‘ ë°ì´í„°ë¥¼ ë‹´ìŠµë‹ˆë‹¤

                                    let dayTime = [sun, mon, tue, wed, thr, fri, sat];



                                    for (k = 0; k < union.length; k++) {

                                        let runningTimeDay = union[k]['runningtime'];

                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');


                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                openingTime = runningTime.split('-')[0];


                                                if (openingTime.includes(':')) {

                                                    openingTime = Number(openingTime.split(':')[0]) + 1;

                                                }


                                                if (runningDay.includes(filterEl[i]) && openingTime < 14) {
                                                    dayTime[i].push(union[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            openingTime = runningTime.split('-')[0];

                                            if (openingTime.includes(':')) {

                                                openingTime = Number(openingTime.split(':')[0]) + 1;

                                            }


                                            if (runningDay.includes(filterEl[i]) && openingTime < 14) {
                                                dayTime[i].push(union[k]);
                                            }


                                        }

                                    }


                                    let reunion = [...new Set([...dayTime[0], ...dayTime[1], ...dayTime[2], ...dayTime[3], ...dayTime[4], ...dayTime[5], ...dayTime[6]])];
                                    

                                    displayMarkers(reunion);

                                    // updateMenu(reunion);

                                }
                                // ìš”ì¼ + ì‹¬ì•¼ìˆ 
                                else if (filtChk[i].checked == true && filtChk2[0].checked == false && filtChk2[1].checked == true) {


                                    day[i] = resArr.filter(function (resArr) {
                                        return resArr['runningtime'].includes(filterEl[i]);
                                    })

                                    let union = [...new Set([...day[0], ...day[1], ...day[2], ...day[3], ...day[4], ...day[5], ...day[6]])];


                                    let midnight = [sun, mon, tue, wed, thr, fri, sat];


                                    for (k = 0; k < union.length; k++) {

                                        let runningTimeDay = union[k]['runningtime'];
                                        
                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');

                                            
                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                closingTime = runningTime.split('-')[1];
                                                

                                                if (closingTime.includes(':')) {

                                                    closingTime = Number(closingTime.split(':')[0]) + 1;

                                                }


                                                if (runningDay.includes(filterEl[i]) && (closingTime < 6 || closingTime == '*')) {
                                                    midnight[i].push(union[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            closingTime = runningTime.split('-')[1];
                                            

                                            if (closingTime.includes(':')) {

                                                closingTime = Number(closingTime.split(':')[0]) + 1;

                                            }

                                            if (runningDay.includes(filterEl[i]) && (closingTime < 6 || closingTime == '*')) {
                                                midnight[i].push(union[k]);
                                            }


                                        }

                                    }


                                    let reunion = [...new Set([...midnight[0], ...midnight[1], ...midnight[2], ...midnight[3], ...midnight[4], ...midnight[5], ...midnight[6]])];
                            
                                    displayMarkers(reunion);

                                }
                                // ìš”ì¼ + ë‚®ìˆ  + ì‹¬ì•¼ìˆ 
                                else if (filtChk[i].checked == true && filtChk2[0].checked == true && filtChk2[1].checked == true) {


                                    day[i] = resArr.filter(function (resArr) {
                                        return resArr['runningtime'].includes(filterEl[i]);
                                    })

                                    let union = [...new Set([...day[0], ...day[1], ...day[2], ...day[3], ...day[4], ...day[5], ...day[6]])];


                                    let placesForAnytime = [];

                                    for (k = 0; k < resArr.length; k++) {

                                        let runningTimeDay = resArr[k]['runningtime'];
                                        
                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');


                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                openingTime = runningTime.split('-')[0];
                                                closingTime = runningTime.split('-')[1];
                                                

                                                if (openingTime.includes(':')) {

                                                    openingTime = Number(openingTime.split(':')[0]) + 1;

                                                }

                                                if (closingTime.includes(':')) {

                                                    closingTime = Number(closingTime.split(':')[0]) + 1;

                                                }

                                                if (runningDay.includes(filterEl[i]) && closingTime < 6 && openingTime < 14) {
                                                    placesForAnytime.push(resArr[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            openingTime = runningTime.split('-')[0];
                                            closingTime = runningTime.split('-')[1];
                                            

                                            if (openingTime.includes(':')) {

                                                openingTime = Number(openingTime.split(':')[0]) + 1;

                                            }

                                            if (closingTime.includes(':')) {

                                                closingTime = Number(closingTime.split(':')[0]) + 1;

                                            }

                                            if (runningDay.includes(filterEl[i]) && closingTime < 6 && openingTime < 14) {
                                                placesForAnytime.push(resArr[k]);
                                            }


                                        }

                                    }


                                    placesForAnytime = [...new Set(placesForAnytime)];

                                    let intersection = union.filter(x => placesForAnytime.includes(x));


                                    displayMarkers(intersection);

                                    // updateMenu(intersection);


                                }
                                // ìš”ì¼ ìƒê´€ì—†ì´ ë‚®ìˆ 
                                else if (filtChk[0].checked == false && filtChk[1].checked == false && filtChk[2].checked == false
                                    && filtChk[3].checked == false && filtChk[4].checked == false && filtChk[5].checked == false
                                    && filtChk[6].checked == false && filtChk2[0].checked == true && filtChk2[1].checked == false) {


                                    displayMarkers(placesForDaytime);

                                    // updateMenu(intersection);


                                }
                                // ìš”ì¼ ìƒê´€ì—†ì´ ì‹¬ì•¼ìˆ  
                                else if (filtChk[0].checked == false && filtChk[1].checked == false && filtChk[2].checked == false
                                    && filtChk[3].checked == false && filtChk[4].checked == false && filtChk[5].checked == false
                                    && filtChk[6].checked == false && filtChk2[0].checked == false && filtChk2[1].checked == true) {


                                    displayMarkers(placesForMidnight);

                                    // updateMenu(intersection);


                                }
                                // ì‹œê°„ ê´€ê³„ì—†ì´ ìš”ì¼ë§Œ ê³ ë¥´ëŠ” ê²½ìš°
                                else if (filtChk[i].checked == true && filtChk2[0].checked == false && filtChk2[1].checked == false) {


                                    day[i] = resArr.filter(function (resArr) {
                                        return resArr['runningtime'].includes(filterEl[i]);
                                    })

                                    let union = [...new Set([...day[0], ...day[1], ...day[2], ...day[3], ...day[4], ...day[5], ...day[6]])];

                                    displayMarkers(union);
                                    // updateMenu(union);

                                }
                                // ìš”ì¼ì€ ê³ ë¥´ì§€ ì•Šê³  ë‚®ìˆ  ì‹¬ì•¼ìˆ  ë‹¤ ë˜ëŠ” ìˆ ì§‘ ê³ ë¥´ëŠ” ê²½ìš°
                                else if (filtChk[0].checked == false && filtChk[1].checked == false && filtChk[2].checked == false
                                    && filtChk[3].checked == false && filtChk[4].checked == false && filtChk[5].checked == false && filtChk[6].checked == false
                                    && filtChk2[j].checked == true) {


                                    let intersection = placesForDaytime.filter(x => placesForMidnight.includes(x))

                                    displayMarkers(intersection);

                                    // updateMenu(intersection);



                                }
                                // ìš”ì¼ë„ ì‹œê°„ë„ ê³ ë¥´ì§€ ì•Šì€ ê²½ìš° 
                                else if (filtChk[0].checked == false && filtChk[1].checked == false && filtChk[2].checked == false
                                    && filtChk[3].checked == false && filtChk[4].checked == false && filtChk[5].checked == false && filtChk[6].checked == false
                                    && filtChk2[0].checked == false && filtChk2[1].checked == false) {

                                    displayMarkers(drunkenVege);

                                    // updateMenu(drunkenVege);

                                }
                            }


                        }

                    }

                    // ê²€ìƒ‰ì–´ê°€ ì…ë ¥ëœ ìƒíƒœì—ì„œ í•„í„°ë§í•˜ëŠ” ê²½ìš°
                    else {
                        for (i = 0; i < filtChk.length; i++) {
                            for (j = 0; j < filtChk2.length; j++) {

                                // ìš”ì¼ + ë‚®ìˆ 
                                if (filtChk[i].checked == true && filtChk2[0].checked == true && filtChk2[1].checked == false) {


                                    day[i] = keywordResArr.filter(function (keywordResArr) {
                                        return keywordResArr['runningtime'].includes(filterEl[i]);
                                    })

                                    let union = [...new Set([...day[0], ...day[1], ...day[2], ...day[3], ...day[4], ...day[5], ...day[6]])];


                                    // ìš”ì¼ì„ ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë§í•œ ìˆ ì§‘ ë°ì´í„°ë¥¼ ë‹´ìŠµë‹ˆë‹¤

                                    let dayTime = [sun, mon, tue, wed, thr, fri, sat];



                                    for (k = 0; k < union.length; k++) {

                                        let runningTimeDay = union[k]['runningtime'];

                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');


                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                openingTime = runningTime.split('-')[0];


                                                if (openingTime.includes(':')) {

                                                    openingTime = Number(openingTime.split(':')[0]) + 1;

                                                }


                                                if (runningDay.includes(filterEl[i]) && openingTime < 14) {
                                                    dayTime[i].push(union[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            openingTime = runningTime.split('-')[0];

                                            if (openingTime.includes(':')) {

                                                openingTime = Number(openingTime.split(':')[0]) + 1;

                                            }


                                            if (runningDay.includes(filterEl[i]) && openingTime < 14) {
                                                dayTime[i].push(union[k]);
                                            }


                                        }

                                    }


                                    let reunion = [...new Set([...dayTime[0], ...dayTime[1], ...dayTime[2], ...dayTime[3], ...dayTime[4], ...dayTime[5], ...dayTime[6]])];
                                    

                                    displayMarkers(reunion);

                                    // updateMenu(reunion);

                                }
                                // ìš”ì¼ + ì‹¬ì•¼ìˆ 
                                else if (filtChk[i].checked == true && filtChk2[0].checked == false && filtChk2[1].checked == true) {


                                    day[i] = keywordResArr.filter(function (keywordResArr) {
                                        return keywordResArr['runningtime'].includes(filterEl[i]);
                                    })

                                    let union = [...new Set([...day[0], ...day[1], ...day[2], ...day[3], ...day[4], ...day[5], ...day[6]])];


                                    let midnight = [sun, mon, tue, wed, thr, fri, sat];


                                    for (k = 0; k < union.length; k++) {

                                        let runningTimeDay = union[k]['runningtime'];
                                        
                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');

                                        
                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                closingTime = runningTime.split('-')[1];
                                                

                                                if (closingTime.includes(':')) {

                                                    closingTime = Number(closingTime.split(':')[0]) + 1;

                                                }


                                                if (runningDay.includes(filterEl[i]) && (closingTime < 6 || closingTime == '*')) {
                                                    midnight[i].push(union[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            closingTime = runningTime.split('-')[1];
                                            

                                            if (closingTime.includes(':')) {

                                                closingTime = Number(closingTime.split(':')[0]) + 1;

                                            }

                                            if (runningDay.includes(filterEl[i]) && (closingTime < 6 || closingTime == '*')) {
                                                midnight[i].push(union[k]);
                                            }


                                        }

                                    }


                                    let reunion = [...new Set([...midnight[0], ...midnight[1], ...midnight[2], ...midnight[3], ...midnight[4], ...midnight[5], ...midnight[6]])];
                                    

                                    displayMarkers(reunion);

                                }
                                // ìš”ì¼ + ë‚®ìˆ  + ì‹¬ì•¼ìˆ 
                                else if (filtChk[i].checked == true && filtChk2[0].checked == true && filtChk2[1].checked == true) {


                                    day[i] = keywordResArr.filter(function (keywordResArr) {
                                        return keywordResArr['runningtime'].includes(filterEl[i]);
                                    })

                                    let union = [...new Set([...day[0], ...day[1], ...day[2], ...day[3], ...day[4], ...day[5], ...day[6]])];


                                    let placesForAnytime = [];

                                    for (k = 0; k < keywordResArr.length; k++) {

                                        let runningTimeDay = keywordResArr[k]['runningtime'];
                                    
                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');

                                            
                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                openingTime = runningTime.split('-')[0];
                                                closingTime = runningTime.split('-')[1];
                                                

                                                if (openingTime.includes(':')) {

                                                    openingTime = Number(openingTime.split(':')[0]) + 1;

                                                }

                                                if (closingTime.includes(':')) {

                                                    closingTime = Number(closingTime.split(':')[0]) + 1;

                                                }

                                                if (runningDay.includes(filterEl[i]) && closingTime < 6 && openingTime < 14) {
                                                    placesForAnytime.push(keywordResArr[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            openingTime = runningTime.split('-')[0];
                                            closingTime = runningTime.split('-')[1];
                                            

                                            if (openingTime.includes(':')) {

                                                openingTime = Number(openingTime.split(':')[0]) + 1;

                                            }

                                            if (closingTime.includes(':')) {

                                                closingTime = Number(closingTime.split(':')[0]) + 1;

                                            }

                                            if (runningDay.includes(filterEl[i]) && closingTime < 6 && openingTime < 14) {
                                                placesForAnytime.push(keywordResArr[k]);
                                            }


                                        }

                                    }


                                    placesForAnytime = [...new Set(placesForAnytime)];

                                    let intersection = union.filter(x => placesForAnytime.includes(x));


                                    displayMarkers(intersection);

                        
                                }
                                // ìš”ì¼ ìƒê´€ì—†ì´ ë‚®ìˆ 
                                else if (filtChk[0].checked == false && filtChk[1].checked == false && filtChk[2].checked == false
                                    && filtChk[3].checked == false && filtChk[4].checked == false && filtChk[5].checked == false
                                    && filtChk[6].checked == false && filtChk2[0].checked == true && filtChk2[1].checked == false) {


                                    dayTime = [];

                                    for (k = 0; k < keywordResArr.length; k++) {

                                        let runningTimeDay = keywordResArr[k]['runningtime'];

                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');


                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                openingTime = runningTime.split('-')[0];


                                                if (openingTime.includes(':')) {

                                                    openingTime = Number(openingTime.split(':')[0]) + 1;

                                                }


                                                if (openingTime < 14) {
                                                    dayTime.push(keywordResArr[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            openingTime = runningTime.split('-')[0];

                                            if (openingTime.includes(':')) {

                                                openingTime = Number(openingTime.split(':')[0]) + 1;

                                            }


                                            if (openingTime < 14) {
                                                dayTime.push(keywordResArr[k]);
                                            }


                                        }

                                    }


                                    let union = [...new Set([...dayTime])];


                                    displayMarkers(union);

                                    // updateMenu(intersection);


                                }
                                // ìš”ì¼ ìƒê´€ì—†ì´ ì‹¬ì•¼ìˆ  
                                else if (filtChk[0].checked == false && filtChk[1].checked == false && filtChk[2].checked == false
                                    && filtChk[3].checked == false && filtChk[4].checked == false && filtChk[5].checked == false
                                    && filtChk[6].checked == false && filtChk2[0].checked == false && filtChk2[1].checked == true) {


                                    midnight = [];

                                    for (k = 0; k < keywordResArr.length; k++) {

                                        let runningTimeDay = keywordResArr[k]['runningtime'];

                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');


                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                closingTime = runningTime.split('-')[1];


                                                if (closingTime.includes(':')) {

                                                    closingTime = Number(closingTime.split(':')[0]) + 1;

                                                }


                                                if (closingTime < 6 || closingTime == '*') {
                                                    midnight.push(keywordResArr[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            closingTime = runningTime.split('-')[1];

                                            if (closingTime.includes(':')) {

                                                closingTime = Number(closingTime.split(':')[0]) + 1;

                                            }


                                            if (closingTime < 6 || closingTime == '*') {
                                                midnight.push(keywordResArr[k]);
                                            }


                                        }

                                    }


                                    let union = [...new Set([...midnight])];


                                    displayMarkers(union);

                                    // updateMenu(intersection);


                                }
                                // ì‹œê°„ ê´€ê³„ì—†ì´ ìš”ì¼ë§Œ ê³ ë¥´ëŠ” ê²½ìš°
                                else if (filtChk[i].checked == true && filtChk2[0].checked == false && filtChk2[1].checked == false) {


                                    day[i] = keywordResArr.filter(function (keywordResArr) {
                                        return keywordResArr['runningtime'].includes(filterEl[i]);
                                    })

                                    let union = [...new Set([...day[0], ...day[1], ...day[2], ...day[3], ...day[4], ...day[5], ...day[6]])];

                                    displayMarkers(union);
                                    // updateMenu(union);

                                }
                                // ìš”ì¼ì€ ê³ ë¥´ì§€ ì•Šê³  ë‚®ìˆ  ì‹¬ì•¼ìˆ  ë‹¤ ë˜ëŠ” ìˆ ì§‘ ê³ ë¥´ëŠ” ê²½ìš°
                                else if (filtChk[0].checked == false && filtChk[1].checked == false && filtChk[2].checked == false
                                    && filtChk[3].checked == false && filtChk[4].checked == false && filtChk[5].checked == false && filtChk[6].checked == false
                                    && filtChk2[j].checked == true) {

                                    anyTime = [];


                                    for (k = 0; k < keywordResArr.length; k++) {

                                        let runningTimeDay = keywordResArr[k]['runningtime'];

                                        if (runningTimeDay.includes('/')) {
                                            runningTimeDay = runningTimeDay.split('/');


                                            for (l = 0; l < runningTimeDay.length; l++) {
                                                runningTime = runningTimeDay[l].split('(')[0];
                                                runningDay = runningTimeDay[l].split('(')[1].split(')')[0];
                                                openingTime = runningTime.split('-')[0];
                                                closingTime = runningTime.split('-')[1];

                                                if (openingTime.includes(':')) {

                                                    openingTime = Number(openingTime.split(':')[0]) + 1;

                                                }

                                                if (closingTime.includes(':')) {

                                                    closingTime = Number(closingTime.split(':')[0]) + 1;

                                                }


                                                if (openingTime < 14 && (closingTime < 6 || closingTime == '*')) {
                                                    anyTime.push(keywordResArr[k]);
                                                }

                                            }

                                        }
                                        else {
                                            runningTime = runningTimeDay.split('(')[0];
                                            runningDay = runningTimeDay.split('(')[1].split(')')[0];
                                            openingTime = runningTime.split('-')[0];
                                            closingTime = runningTime.split('-')[1];

                                            if (openingTime.includes(':')) {

                                                openingTime = Number(openingTime.split(':')[0]) + 1;

                                            }


                                            if (closingTime.includes(':')) {

                                                closingTime = Number(closingTime.split(':')[0]) + 1;

                                            }

                                            if (openingTime < 14 && (closingTime < 6 || closingTime == '*')) {
                                                anyTime.push(keywordResArr[k]);
                                            }


                                        }

                                    }


                                    let union = [...new Set([...anyTime])];

                                    displayMarkers(union);

                                    // updateMenu(intersection);



                                }
                                // ìš”ì¼ë„ ì‹œê°„ë„ ê³ ë¥´ì§€ ì•Šì€ ê²½ìš° 
                                else if (filtChk[0].checked == false && filtChk[1].checked == false && filtChk[2].checked == false
                                    && filtChk[3].checked == false && filtChk[4].checked == false && filtChk[5].checked == false && filtChk[6].checked == false
                                    && filtChk2[0].checked == false && filtChk2[1].checked == false) {

                                    displayMarkers(keywordResArr);

                                    // updateMenu(drunkenVege);

                                }
                            }


                        }
                    }


                }

            })

        }



        // ì¥ì†Œì™€ ìš”ì¼ ê¸°ë°˜ ê²€ìƒ‰ì˜ ê²°ê³¼ì— ë”°ë¼ ì•ˆì£¼ ì •ë³´ì°½ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
        function updateMenu(list) {

            let menuListEl = document.getElementById('menuList');
            
            removeAllChildNods(menuListEl);


            for (i = 0; i < list.length; i++) {
                let menuList = list[i]['menu'].split('/');
                

                for (j = 0; j < menuList.length; j++) {

                    var x = document.createElement("li");

                    var menuName = 'ğŸ‘½' + menuList[j].split('+')[0];

                    var menuPrice = 'âš¡' + menuList[j].split('+')[1] + 'ì›';

                    var menuNamePrice = menuName + '   ' + menuPrice;

                    var t = document.createTextNode(menuNamePrice);

                    x.appendChild(t);

                    document.getElementById("menuList").appendChild(x);

                }
            }

        }



        // ì§€ë„ ìœ„ì— ë§ˆì»¤ë¥¼ ì°ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
        function displayMarkers(list) {
            var listEl = document.getElementById('placesList'),
                menuEl = document.getElementById('menu_wrap'),
                fragment = document.createDocumentFragment(),
                listStr = '';

            // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ì— ì¶”ê°€ëœ í•­ëª©ë“¤ì„ ì œê±°í•©ë‹ˆë‹¤
            removeAllChildNods(listEl);

            // ì§€ë„ë¥¼ ì¬ì„¤ì •í•  ë²”ìœ„ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì„ LatLngBounds ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
            var bounds = new kakao.maps.LatLngBounds();

            // ì§€ë„ì— í‘œì‹œë˜ê³  ìˆëŠ” ë§ˆì»¤ë¥¼ ì œê±°í•©ë‹ˆë‹¤
            removeMarker();

            if (list.length != 0) {
                for (var i = 0; i < list.length; i++) {

                    // ë§ˆì»¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                    var placePosition = new kakao.maps.LatLng(list[i]['latitude'], list[i]['longitude']),
                        title = list[i]['name'],
                        marker = addMarker(placePosition, i, title), // ê²€ìƒ‰ ê²°ê³¼ ë§ˆì»¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                        itemEl = getListItem(i, list[i]); // ê²€ìƒ‰ ê²°ê³¼ í•­ëª© Elementë¥¼ ìƒì„±í•©ë‹ˆë‹¤


                    // ê²€ìƒ‰ëœ ì¥ì†Œ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ë„ ë²”ìœ„ë¥¼ ì¬ì„¤ì •í•˜ê¸°ìœ„í•´
                    // LatLngBounds ê°ì²´ì— ì¢Œí‘œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤
                    bounds.extend(placePosition);

                    // ë§ˆì»¤ì— í‘œì‹œí•  ì¸í¬ìœˆë„ìš°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤ 
                    var infowindow = new kakao.maps.InfoWindow({
                        content: '<div style="padding:10px; width: 250px; z-index:1;">' + list[i]['address'] + '</div>' // ì¸í¬ìœˆë„ìš°ì— í‘œì‹œí•  ë‚´ìš©
                    });

                    // ë§ˆì»¤ì— ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•˜ëŠ” í•¨ìˆ˜ ë§Œë“¤ê³  ì¦‰ì‹œ í˜¸ì¶œí•˜ì—¬ í´ë¡œì €ë¥¼ ë§Œë“­ë‹ˆë‹¤
                    // í´ë¡œì €ë¥¼ ë§Œë“¤ì–´ ì£¼ì§€ ì•Šìœ¼ë©´ ë§ˆì§€ë§‰ ë§ˆì»¤ì—ë§Œ ì´ë²¤íŠ¸ê°€ ë“±ë¡ë©ë‹ˆë‹¤
                    (function (marker, infowindow) {
                        // ë§ˆì»¤ì— click ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•˜ê³  ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ ì¸í¬ìœˆë„ìš°ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤ 
                        kakao.maps.event.addListener(marker, 'click', function () {
                            infowindow.open(map, marker);
                        });

                        // ë§ˆì»¤ì— mouseout ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•˜ê³  ë§ˆìš°ìŠ¤ ì•„ì›ƒ ì‹œ ì¸í¬ìœˆë„ìš°ë¥¼ ë‹«ìŠµë‹ˆë‹¤
                        kakao.maps.event.addListener(marker, 'mouseout', function () {
                            infowindow.close();
                        });
                    })(marker, infowindow);

                    fragment.appendChild(itemEl);

                }


                // ê²€ìƒ‰ê²°ê³¼ í•­ëª© ìˆ˜ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤
                var numStr = i;

                document.getElementById("numofResults").innerHTML = '<p>' + 'ì´ ' + numStr + 'ê°œì˜ ê²€ìƒ‰ê²°ê³¼ê°€ ìˆìŠµë‹ˆë‹¤.' + '</p>';

                // ê²€ìƒ‰ê²°ê³¼ í•­ëª©ë“¤ì„ ê²€ìƒ‰ê²°ê³¼ ëª©ë¡ Elemnetì— ì¶”ê°€í•©ë‹ˆë‹¤
                listEl.appendChild(fragment);
                menuEl.scrollTop = 0;

                map.setBounds(bounds);

            } else {

                // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ì— ì¶”ê°€ëœ í•­ëª©ë“¤ì„ ì œê±°í•©ë‹ˆë‹¤
                var listEl = document.getElementById('placesList');
                removeAllChildNods(listEl);

                // ì§€ë„ë¥¼ ì¬ì„¤ì •í•  ë²”ìœ„ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì„ LatLngBounds ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                var bounds = new kakao.maps.LatLngBounds();

                // ì§€ë„ì— í‘œì‹œë˜ê³  ìˆëŠ” ë§ˆì»¤ë¥¼ ì œê±°í•©ë‹ˆë‹¤
                removeMarker();

                // ê²€ìƒ‰ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒì„ í‘œê¸°í•©ë‹ˆë‹¤
                document.getElementById("numofResults").innerHTML = '<p>' + 'ê²€ìƒ‰ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' + '</p>';


            }


        }


    </script>


    </div>



</body>

</html>